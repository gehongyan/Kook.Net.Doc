<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>频道相关接口 | Kook.Net 文档 </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="频道相关接口 | Kook.Net 文档 ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/gehongyan/Kook.Net/blob/master/docs/quick_reference/http_api/channel.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  <meta property="og:description" content="预声明变量"><meta property="og:title" content="频道相关接口 | Kook.Net 文档 "><meta property="og:site_name" content="Discord.Net Docs"><meta name="theme-color" content="#995EA7"><meta property="og:image" content="https://raw.githubusercontent.com/Discord-Net/Discord.Net/dev/docs/marketing/logo/PackageLogo.png"></head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo/Logo_Small.png" alt="Kook.Net 文档">
            Kook.Net 文档
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="Guides.QuickReference.Http.Channel">
<h1 id="频道相关接口">频道相关接口</h1>

<p>预声明变量</p>
<pre><code class="lang-csharp">readonly KookSocketClient _socketClient = null;
readonly KookRestClient _restClient = null;

SocketGuild socketGuild = null;
SocketVoiceChannel socketVoiceChannel = null;
SocketCategoryChannel socketCategoryChannel = null;

RestGuild restGuild = null;

IGuild guild = null;
IGuildUser guildUser = null;
IGuildChannel guildChannel = null;
ITextChannel textChannel = null;
IVoiceChannel voiceChannel = null;
INestedChannel nestedChannel = null;
ICategoryChannel categoryChannel = null;
</code></pre>
<h3 id="获取频道列表"><a href="https://developer.kookapp.cn/doc/http/channel#%E8%8E%B7%E5%8F%96%E9%A2%91%E9%81%93%E5%88%97%E8%A1%A8">获取频道列表</a></h3>
<p>GET <code>/api/v3/channel/list</code></p>
<pre><code class="lang-csharp">// 缓存获取指定服务器的全部频道
IReadOnlyCollection&lt;SocketGuildChannel&gt; socketGuildChannels = socketGuild.Channels;
IReadOnlyCollection&lt;RestGuildChannel&gt; restGuildChannels = restGuild.Channels;
// 缓存获取指定服务器的全部文字频道
IReadOnlyCollection&lt;SocketTextChannel&gt; socketTextChannels = socketGuild.TextChannels;
IReadOnlyCollection&lt;RestTextChannel&gt; restTextChannels = restGuild.TextChannels;
// 缓存获取指定服务器的全部语音频道
IReadOnlyCollection&lt;SocketVoiceChannel&gt; socketVoiceChannels = socketGuild.VoiceChannels;
IReadOnlyCollection&lt;RestVoiceChannel&gt; restVoiceChannels = restGuild.VoiceChannels;
// 缓存获取指定服务器的全部分组频道
IReadOnlyCollection&lt;SocketCategoryChannel&gt; socketCategoryChannels = socketGuild.CategoryChannels;
IReadOnlyCollection&lt;RestCategoryChannel&gt; restCategoryChannels = restGuild.CategoryChannels;
// 缓存获取指定服务器分组频道下的全部频道
IReadOnlyCollection&lt;SocketGuildChannel&gt; socketChannelsInCategory = socketCategoryChannel.Channels;

// API 请求
IReadOnlyCollection&lt;RestGuildChannel&gt; restGuildChannels = await restGuild.GetChannelsAsync();
IReadOnlyCollection&lt;RestTextChannel&gt; restTextChannels = await restGuild.GetTextChannelsAsync();
IReadOnlyCollection&lt;RestVoiceChannel&gt; restVoiceChannels = await restGuild.GetVoiceChannelsAsync();
IReadOnlyCollection&lt;RestCategoryChannel&gt; restCategoryChannels = await restGuild.GetCategoryChannelsAsync();

// 如果 IGuild 对象是 SocketGuild，则直接返回缓存的频道列表，否则会发起 API 请求获取全部频道信息
IReadOnlyCollection&lt;IGuildChannel&gt; guildChannels = await guild.GetChannelsAsync();
IReadOnlyCollection&lt;ITextChannel&gt; textChannels = await guild.GetTextChannelAsyncs();
IReadOnlyCollection&lt;IVoiceChannel&gt; voiceChannels = await guild.GetVoiceChannelAsyncs();
IReadOnlyCollection&lt;ICategoryChannel&gt; categoryChannels = await guild.GetCategoryChannelAsyncs();
</code></pre>
<h3 id="获取频道详情"><a href="https://developer.kookapp.cn/doc/http/channel#%E8%8E%B7%E5%8F%96%E9%A2%91%E9%81%93%E8%AF%A6%E6%83%85">获取频道详情</a></h3>
<p>GET <code>/api/v3/channel/view</code></p>
<pre><code class="lang-csharp">ulong channelId = default; // 频道 ID
// 缓存获取指定的服务器频道
SocketChannel socketChannel = _socketClient.GetChannel(channelId);
SocketChannel socketChannel = socketGuild.GetChannel(channelId);
RestGuildChannel restGuildChannel = restGuild.Channels.FirstOrDefault(x =&gt; x.Id == channelId);
// 缓存获取指定的服务器文字频道
SocketTextChannel socketTextChannel = socketGuild.GetTextChannel(channelId);
RestTextChannel restTextChannel = restGuild.TextChannels.FirstOrDefault(x =&gt; x.Id == channelId);
// 缓存获取指定的服务器语音频道
SocketVoiceChannel socketVoiceChannel = socketGuild.GetVoiceChannel(channelId);
RestVoiceChannel restVoiceChannel = restGuild.VoiceChannels.FirstOrDefault(x =&gt; x.Id == channelId);
// 缓存获取指定的服务器分组频道
SocketCategoryChannel socketCategoryChannel = socketGuild.GetCategoryChannel(channelId);
RestCategoryChannel restCategoryChannel = restGuild.CategoryChannels.FirstOrDefault(x =&gt; x.Id == channelId);

// API 请求
RestChannel restChannel = await _restClient.GetChannelAsync(channelId);
RestGuildChannel restGuildChannel = await restGuild.GetChannelAsync(channelId);
RestTextChannel restTestChannel = await restGuild.GetTextChannelAsync(channelId);
RestVoiceChannel restVoiceChannel = await restGuild.GetVoiceChannelAsync(channelId);
RestCategoryChannel restCategoryChannel = await restGuild.GetCategoryChannelAsync(channelId);

// 如果 IGuild 对象是 SocketGuild，则直接返回缓存的频道，否则会发起 API 请求获取指定的频道信息
IChannel channel = await _socketClient.GetChannelAsync(channelId);
IGuildChannel guildChannel = await guild.GetChannelAsync(channelId);
ITextChannel textChannel = await guild.GetTextChannelAsync(channelId);
IVoiceChannel voiceChannel = await guild.GetVoiceChannelAsync(channelId);
ICategoryChannel categoryChannel = await guild.GetCategoryChannelAsync(channelId);
</code></pre>
<h3 id="创建频道"><a href="https://developer.kookapp.cn/doc/http/channel#%E5%88%9B%E5%BB%BA%E9%A2%91%E9%81%93">创建频道</a></h3>
<p>POST <code>/api/v3/channel/create</code></p>
<pre><code class="lang-csharp">string name = null; // 频道名称
ulong categoryChannelId = default; // 分组频道 ID
string topic = null; // 文字频道主题
int userLimit = default; // 语音频道用户数上限
VoiceQuality voiceQuality = default; // 语音频道语音质量

// API 请求，创建文字频道
ITextChannel textChannel = await guild.CreateTextChannelAsync(name);
ITextChannel textChannel = await guild.CreateTextChannelAsync(name, x =&gt;
{
    x.CategoryId = categoryChannelId;
    x.Topic = topic;
});
// API 请求，创建语音频道
IVoiceChannel voiceChannel = await guild.CreateVoiceChannelAsync(name);
IVoiceChannel voiceChannel = await guild.CreateVoiceChannelAsync(name, x =&gt;
{
    x.CategoryId = categoryChannelId;
    x.UserLimit = userLimit;
    x.VoiceQuality = voiceQuality;
});
// API 请求，创建分组频道
ICategoryChannel categoryChannel = await guild.CreateCategoryChannelAsync(name);
</code></pre>
<h3 id="编辑频道"><a href="https://developer.kookapp.cn/doc/http/channel#%E7%BC%96%E8%BE%91%E9%A2%91%E9%81%93">编辑频道</a></h3>
<p>POST <code>/api/v3/channel/update</code></p>
<pre><code class="lang-csharp">string name = null; // 频道名称
ulong categoryChannelId = default; // 分组频道 ID
int position = default; // 频道排序位置
string topic = null; // 文字频道主题
SlowModeInterval slowModeInterval = default; // 文字频道慢速模式间隔
int userLimit = default; // 语音频道用户数上限
VoiceQuality voiceQuality = default; // 语音频道语音质量
string password = null; // 语音频道密码

// API 请求，修改频道
guildChannel.ModifyAsync(x =&gt;
{
    x.Name = name;
    x.CategoryId = categoryChannelId;
    x.Position = position;
});
// API 请求，修改文字频道
textChannel.ModifyAsync(x =&gt;
{
    x.Name = name;
    x.CategoryId = categoryChannelId;
    x.Position = position;
    x.Topic = topic;
    x.SlowModeInterval = slowModeInterval;
});
// API 请求，修改语音频道
voiceChannel.ModifyAsync(x =&gt;
{
    x.Name = name;
    x.CategoryId = categoryChannelId;
    x.Position = position;
    x.VoiceQuality = voiceQuality;
    x.UserLimit = userLimit;
    x.Password = password;
});
// API 请求，修改分组频道
categoryChannel.ModifyAsync(x =&gt;
{
    x.Name = name;
    x.CategoryId = categoryChannelId;
    x.Position = position;
});
</code></pre>
<h3 id="删除频道"><a href="https://developer.kookapp.cn/doc/http/channel#%E5%88%A0%E9%99%A4%E9%A2%91%E9%81%93">删除频道</a></h3>
<p>POST <code>/api/v3/channel/delete</code></p>
<pre><code class="lang-csharp">// API 请求
await guildChannel.DeleteAsync();
</code></pre>
<h3 id="语音频道用户列表"><a href="https://developer.kookapp.cn/doc/http/channel#%E8%AF%AD%E9%9F%B3%E9%A2%91%E9%81%93%E7%94%A8%E6%88%B7%E5%88%97%E8%A1%A8">语音频道用户列表</a></h3>
<p>GET <code>/api/v3/channel/user-list</code></p>
<pre><code class="lang-csharp">// 要在启动时缓存语音状态信息，请设置 AlwaysDownloadVoiceStates = true
// 主动更新所有服务器语音状态信息缓存
await _socketClient.DownloadVoiceStatesAsync();
// 缓存获取
IReadOnlyCollection&lt;SocketGuildUser&gt; connectedGuildUsers = socketVoiceChannel.ConnectedUsers;
// API 请求
IReadOnlyCollection&lt;IUser&gt; connectedUsers = await voiceChannel.GetConnectedUsersAsync();
</code></pre>
<h3 id="语音频道之间移动用户"><a href="https://developer.kookapp.cn/doc/http/channel#%E8%AF%AD%E9%9F%B3%E9%A2%91%E9%81%93%E4%B9%8B%E9%97%B4%E7%A7%BB%E5%8A%A8%E7%94%A8%E6%88%B7">语音频道之间移动用户</a></h3>
<p>POST <code>/api/v3/channel/move-user</code></p>
<pre><code class="lang-csharp">// 要移动的服务器用户列表
IEnumerable&lt;IGuildUser&gt; guildUsers = null;
// API 请求
await guild.MoveUsersAsync(guildUsers, voiceChannel);
</code></pre>
<h3 id="获取频道角色权限详情"><a href="https://developer.kookapp.cn/doc/http/channel#%E9%A2%91%E9%81%93%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90%E8%AF%A6%E6%83%85">获取频道角色权限详情</a></h3>
<p>GET <code>/api/v3/channel-role/index</code></p>
<pre><code class="lang-csharp">IRole role = null; // 要获取在该频道的权限覆盖配置的角色
IUser user = null; // 要获取在该频道的权限覆盖配置的用户

// 缓存获取频道的角色或用户权限覆盖配置
IReadOnlyCollection&lt;RolePermissionOverwrite&gt; rolePermissionOverwrites = guildChannel.RolePermissionOverwrites;
IReadOnlyCollection&lt;UserPermissionOverwrite&gt; userPermissionOverwrites = guildChannel.UserPermissionOverwrites;
// 缓存获取频道的指定角色或用户的权限覆盖配置
OverwritePermissions? rolePermissionOverwrite = guildChannel.GetPermissionOverwrite(role);
OverwritePermissions? userPermissionOverwrite = guildChannel.GetPermissionOverwrite(user);
</code></pre>
<h3 id="创建频道角色权限"><a href="https://developer.kookapp.cn/doc/http/channel#%E5%88%9B%E5%BB%BA%E9%A2%91%E9%81%93%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90">创建频道角色权限</a></h3>
<p>POST <code>/api/v3/channel-role/create</code></p>
<pre><code class="lang-csharp">IRole role = null; // 要在该频道创建权限覆盖配置的角色
IGuildUser guildUser = null; // 要在该频道创建权限覆盖配置的服务器用户

// API 请求
await guildChannel.AddPermissionOverwriteAsync(role);
await guildChannel.AddPermissionOverwriteAsync(guildUser);
</code></pre>
<h3 id="更新频道角色权限"><a href="https://developer.kookapp.cn/doc/http/channel#%E6%9B%B4%E6%96%B0%E9%A2%91%E9%81%93%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90">更新频道角色权限</a></h3>
<p>POST <code>/api/v3/channel-role/update</code></p>
<pre><code class="lang-csharp">IRole role = null; // 要在该频道修改权限覆盖配置的角色
IGuildUser guildUser = null; // 要在该频道修改权限覆盖配置的服务器用户

// API 请求
await guildChannel.ModifyPermissionOverwriteAsync(role, x =&gt; x.Modify());
await guildChannel.ModifyPermissionOverwriteAsync(role, x =&gt; x.Modify());
</code></pre>
<h3 id="同步频道角色权限"><a href="https://developer.kookapp.cn/doc/http/channel#%E5%90%8C%E6%AD%A5%E9%A2%91%E9%81%93%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90">同步频道角色权限</a></h3>
<p>POST <code>/api/v3/channel-role/sync</code></p>
<pre><code class="lang-csharp">// API 请求
await nestedChannel.SyncPermissionsAsync();
</code></pre>
<h3 id="删除频道角色权限"><a href="https://developer.kookapp.cn/doc/http/channel#%E5%88%A0%E9%99%A4%E9%A2%91%E9%81%93%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90">删除频道角色权限</a></h3>
<p>POST <code>/api/v3/channel-role/delete</code></p>
<pre><code class="lang-csharp">// API 请求
await guildChannel.RemovePermissionOverwriteAsync(role);
await guildChannel.RemovePermissionOverwriteAsync(guildUser);
</code></pre>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/gehongyan/Kook.Net/blob/master/docs/quick_reference/http_api/channel.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Kook.Net (c) 2022-2024
        </div>
      </div>
    </footer>
  </body>
</html>
